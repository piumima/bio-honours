##legend=c("LC10 Ponds","LC50 Ponds","LC10 Lakes","LC50 Lakes"),
##args.legend=list(x="topright")
)
lab<-colnames(data)
text(x, par("usr")[3], labels = labs, srt = 45,
adj = c(1.1,1.1), xpd = TRUE, cex=.9)
text(cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45, pos=2)
x<-barplot(data,
beside=TRUE,
ylim=c(140,170),
xpd=FALSE,
col=col,
las=2,
ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",
xaxt="n"
##legend=c("LC10 Ponds","LC50 Ponds","LC10 Lakes","LC50 Lakes"),
##args.legend=list(x="topright")
)
lab<-colnames(data)
text(cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45, pos=2)
text(x,cex=1, x=x-.25, y=-1.25, labs, xpd=TRUE, srt=45, pos=2)
mtcars
end_point = 0.5 + ncol(data) + ncol(data)-1
x<-barplot(data,
beside=TRUE,
ylim=c(140,170),
xpd=FALSE,
col=col,
las=2,
ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",
xaxt="n",
space=1
##legend=c("LC10 Ponds","LC50 Ponds","LC10 Lakes","LC50 Lakes"),
##args.legend=list(x="topright")
)
end_point = 0.5 + ncol(data) + ncol(data)-1
lab<-colnames(data)
text(seq(1.5,end_point,by=2), par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = lab), cex=0.65)
x<-barplot(data,
beside=TRUE,
ylim=c(140,170),
col=col,
xpd=FALSE,
las=2,
ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",
xaxt="n",
space=1
##legend=c("LC10 Ponds","LC50 Ponds","LC10 Lakes","LC50 Lakes"),
##args.legend=list(x="topright")
)
x<-barplot(data,
beside=TRUE,
ylim=c(140,170),
xpd=FALSE,
col=col,
las=2,
ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",
xaxt="n",
##legend=c("LC10 Ponds","LC50 Ponds","LC10 Lakes","LC50 Lakes"),
##args.legend=list(x="topright")
)
end_point = 0.5 + ncol(data) + ncol(data)-1
lab<-colnames(data)
text(seq(1.5,end_point,by=2), par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = lab), cex=0.65)
def.par <- par(no.readonly = TRUE)
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line")
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)),rep(1.4,length(xx)), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
def.par <- par(no.readonly = TRUE)
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)),rep(1.4,length(xx)), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
x<-barplot(data,
beside=TRUE,
ylim=c(140,170),
xpd=FALSE,
col=col,
las=2,
ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",
xaxt="n",
##legend=c("LC10 Ponds","LC50 Ponds","LC10 Lakes","LC50 Lakes"),
##args.legend=list(x="topright")
)
lab<-colnames(data)
text(cex=1, x=colMeans(x)-.25, y=-1.25, labs, xpd=TRUE, srt=45)
text(cex=1, x=colMeans(x)-.25, y=-1.25, labs, xpd=TRUE, srt=45, adj=1)
length(x)
seq_len(length(x))
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)/2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)/2),rep(2.8,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## respect relations between widths and heights
## allocate figure 2 for barplot labels
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)/2),rep(2.8,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)/2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq_len(length(xx)/2),rep(2,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
x <- barplot(table(mtcars$cyl), xaxt="n")
labs <- paste(names(table(mtcars$cyl)), "cylinders")
text(cex=1, x=colMeans(x)-.25, y=-1.25, labs, xpd=TRUE, srt=45)
help(text)
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60,
col=c("darkred","red","grey20","grey40"))
par(def.par)  #- reset to default
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
par(def.par)  #- reset to default
seq(1.5,42,2)
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
par(def.par)  #- reset to default
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.75,
inset=0.01)
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.75,
inset=0.01)
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
par(def.par)  #- reset to default
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.9,
inset=0.05)
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
par(def.par)  #- reset to default
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.9,
inset=0.05)
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
axis(1,labels="Clones")
library(MASS)
toxTest<-read.csv('toxTest.csv')
glmlist<-vector(mode="list",length=21)
doselist<-vector(mode="list",length=21)
for (i in 3:23){
tox.temp<-toxTest[complete.cases(toxTest[,i]),c(2,i)]
tox.temp<-tox.temp[-1,]
dead<-tox.temp[,2]
alive<-100-tox.temp[,2]
glmlist[[i-2]]<-glm(cbind(dead,alive) ~ log(tox.temp$Conc), family = binomial(link = "probit"))
doselist[[i-2]]<-dose.p(glmlist[[i-2]],1:2,c(0.1,0.5))
}
lc50<-numeric(length=21)
lc50SE<-numeric(length=21)
lc10<-numeric(length=21)
lc10SE<-numeric(length=21)
for (i in 1:21){
lc50[i]<-exp(doselist[[i]][2])
lc50SE[i]<-attr(doselist[[i]],"SE")[2]
lc10[i]<-exp(doselist[[i]][1])
lc10SE[i]<-attr(doselist[[i]],"SE")[1]
}
LC<-data.frame(Type=rep(c("Pond","Lake"),c(12,9)),
Habitat=gsub('.[0-9]+',"",names(toxTest[3:23])),
Clone=names(toxTest[3:23]),
lc10,
lc10SE,
lc50,
lc50SE)
View(LC)
LC$lc50-LC$lc10
order(LC$lc50-LC$lc10)
LC[order(LC$lc50-LC$lc10),3]
LC[order(LC$lc50-LC$lc10),]
diff<-lc50-lc10
LC<-data.frame(Type=rep(c("Pond","Lake"),c(12,9)),
Habitat=gsub('.[0-9]+',"",names(toxTest[3:23])),
Clone=names(toxTest[3:23]),
lc10,
lc10SE,
lc50,
lc50SE,
diff)
mean(diff)
sd(diff)
write.csv(LC,"LCcalcul.csv")
?wilcox.test
wilcox.test(ponds$lc50,lakes$lc50, paired=FALSE, alternative="less") ##signif diff
LC$Type<-as.factor(LC$Type)
ponds<-subset(LC,Type=="Pond")
lakes<-subset(LC,Type=="Lake")
wilcox.test(ponds$lc50,lakes$lc50, paired=FALSE, alternative="less") ##signif diff
LC1<-LC[-c(5,8,21),]
LC1$Habitat<-as.factor(LC1$Habitat)
LC1$Habitat<-droplevels(LC1$Habitat)
##calculate sample means per Habitat of lc50 and lc10
setwd("C:/Users/Piumi/OneDrive/McGill Academics/2013-2014/Honours/Tanks")
tankCounts<-read.csv("TankCounts2.csv")
tankCounts$Diversity<-as.factor(tankCounts$Diversity)
tankCounts$ID<-as.factor(tankCounts$ID)
tankCounts$Copper<-as.factor(tankCounts$Copper)
dates<-c(0,7,14,20,36)
max.days<-character(length=18)
r1<-numeric(length=18)
r2<-numeric(length=18)
for (i in 1:18){
ind<-which.max(tankCounts[i,5:7])
r1[i]<-log(tankCounts[i,ind+4]/48)/dates[ind]
r3<-numeric(length=18)
ind<-which.max(tankCounts[i,5:8])
r2[i]<-log(tankCounts[i,ind+4]/48)/dates[ind]
ind<-which.max(tankCounts[i,5:9])
}
tankCounts$r1<-r1
r3[i]<-log(tankCounts[i,ind+4]/48)/dates[ind]
tankCounts$r2<-r2
tankCounts$r3<-r3
fit<-lmerTest::lmer(COV~Diversity+Copper+Copper*Diversity+(1|ID),
tankCounts)
lmerTest::anova(fit)
fit<-lmerTest::lmer(COV~Diversity+Copper+Copper*Diversity+(1|ID/Diversity),
tankCounts)
lmerTest::anova(fit)
fit4<-lmerTest::lmer(r3~Diversity+Copper+Copper*Diversity+(1|ID),
tankCounts)
lmerTest::anova(fit4)
fit3<-lmerTest::lmer(r2~Diversity+Copper+Copper*Diversity+(1|ID),
tankCounts)
lmerTest::anova(fit3)
View(tankCounts)
tankCounts<-read.csv("TankCounts2.csv")
tankCounts$Diversity<-as.factor(tankCounts$Diversity)
tankCounts$ID<-as.factor(tankCounts$ID)
tankCounts$Copper<-as.factor(tankCounts$Copper)
View(tankCounts)
dates<-c(0,7,14,20,36)
max.days<-character(length=18)
r1<-numeric(length=18)
r2<-numeric(length=18)
r3<-numeric(length=18)
for (i in 1:18){
ind<-which.max(tankCounts[i,5:7])
r1[i]<-log(tankCounts[i,ind+4]/48)/dates[ind]
ind<-which.max(tankCounts[i,5:8])
r2[i]<-log(tankCounts[i,ind+4]/48)/dates[ind]
ind<-which.max(tankCounts[i,5:9])
r3[i]<-log(tankCounts[i,ind+4]/48)/dates[ind]
}
View(tankCounts)
tankCounts$r1<-r1
tankCounts$r2<-r2
tankCounts$r3<-r3
View(tankCounts)
fit4<-lmerTest::lmer(r3~Diversity+Copper+Copper*Diversity+(1|ID),
tankCounts)
lmerTest::anova(fit4)
fit<-aov(r3~Copper*Diversity+Error(ID),
tankCounts)
summary(fit)
fit<-aov(COV~Copper*Diversity+Error(ID),
tankCounts)
summary(fit)
fit<-lmerTest::lmer(COV~Diversity+Copper+Copper*Diversity+(1|ID),
tankCounts)
lmerTest::anova(fit)
fit<-aov(COV~Copper*Diversity+Error(ID),
tankCounts)
summary(fit)
?anova
?lmertest
??lmerTest
lmerTest::anova(fit4,ddf="Kenward-Roger")
lmerTest::anova(fit,ddf="Kenward-Roger")
fit<-lmerTest::lmer(COV~Diversity+Copper+Copper*Diversity+(1|ID),
tankCounts)
lmerTest::anova(fit,ddf="Kenward-Roger")
lmerTest::anova(fit,ddf="lme4")
lmerTest::anova(fit,ddf="Satterthwaite")
fit<-aov(r3~Copper*Diversity+Error(ID),
tankCounts)
summary(fit)
