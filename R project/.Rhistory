for (i in 2:22){
toxTest[complete.cases(toxTest[,i]),]
glmlist<-glm(cbind(toxTest[,i],100-toxTest[,i]) ~ toxTest[,1], family = binomial(link = "probit"))
doselist[[i-1]]<-dose.p(glmlist,1:2,0.5)
}
fix(glmlist)
fix(glmlist)
doselist[1]
fix(doselist)
fix(doselist)
fix(doselist)
fix(doselist)
fix(bn29lc50)
fix(doselist)
?structure
unclass(bn29lc50)
names(unclass(bn29lc50))
summary(bn29lc50)
str(bn29lc50)
get(bn29lc50)
?dose.p
fix(twoprob)
bn29lc50[1]
bn29lc50[1:1]
bn29lc50[1:2]
bn29lc50[2]
a<-bn29lc50[1]
fix(a)
fix(a)
doselist[1[1]]
doselist[1[1[1]]]
what<-doselist[1]
fix(what)
fix(twoprob)
what<-doselist[[1]
j
what<-doselist[[1]]
doselist[[1[1]]]
lc50<-numeric(length=21)
for (i in 1:21){
doseobject<-doselist[[i]]
lc50[i]<-doseobject[1]
}
lc50
dose10percent<-vector(mode="list",length=21)
for (i in 2:22){
toxTest[complete.cases(toxTest[,i]),]
glmlist<-glm(cbind(toxTest[,i],100-toxTest[,i]) ~ toxTest[,1], family = binomial(link = "probit"))
doselist[[i-1]]<-dose.p(glmlist,1:2,0.5)
dose10percent[[i-1]]<-dose.p(glmlist,1:2,0.1)
}
lc10<-numeric(length=21)
for (i in 1:21){
doseobject<-doselist[[i]]
lc50[i]<-doseobject[1]
doseobject<-dose10percent[[i]]
lc10[i]<-doseobject[1]
}
lc10
fix(lc50)
fix(lc10)
View(toxTest)
write.csv(file=toxTest,x=toxTest)
?write.csv
write.csv(file="toxTest",x=toxTest)
LC<-read.csv("LCresults.csv")
View(LC)
factor(LC$Type)
?t.test
ponds<-subset(LC,$Type==Pond)
ponds<-subset(LC,Type==Pond)
ponds<-subset(LC,Type=="Pond")
View(ponds)
lakes<-subset(LC,Type=="Lake")
plot(twoprob)
t.test<-(ponds,lakes,paired=FALSE)
t.test(ponds,lakes,paired=FALSE)
View(ponds)
t.test(ponds$LC50,lakes$LC50,paired=FALSE)
t.test(ponds$LC10,lakes$LC10,paired=FALSE)
t.test(ponds$LC10,lakes$LC10,paired=FALSE)
var.test(ponds$LC50,lakes$LC50)
var.test(ponds$LC10,lakes$LC10)
LC<-read.csv("LCresults.csv")
View(LC)
View(LC)
LC<-read.csv("LCresults.csv")
View(LC)
factor(LC$Habitat)
a<-aov(LC50~Habitat,data=LC)
summary(a)
b<-aov(LC10~Habitat,data=LC)
summary(b)
TukeyHSD(a)
plot(TukeyHSD(a))
TukeyHSD(b)
lc50<-numeric(length=21)
lc50SE<-numeric(length=21)
lc10<-numeric(length=21)
lc10SE<-numeric(length=21)
for (i in 1:21){
doseobject<-doselist[[i]]
lc50[i]<-doseobject[1]
lc50SE[i]<-attr(doseobject,"SE")
doseobject<-dose10percent[[i]]
lc10[i]<-doseobject[1]
lc10SE[i]<-attr(doseobject,"SE")
}
fix(lc10SE)
fix(lc10SE)
fix(lc50SE)
attr(doselist[[9]],"SE")
doselist[[9]]
toxTest[complete.cases(toxTest[,10]),]
View(toxTest)
View(toxTest)
glmlist<-glm(cbind(toxTest[,10],100-toxTest[,10]) ~ toxTest[,1], family = binomial(link = "probit"))
dose.p(glmlist,1:2,0.5)
LC$Type<-as.factor(LC$Type)
ponds<-subset(LC,Type=="Pond")
lakes<-subset(LC,Type=="Lake")
t.test(ponds$LC50,lakes$LC50,paired=FALSE)
t.test(ponds$LC10,lakes$LC10,paired=FALSE)
LC$Habitat<-as.factor(LC$Habitat)
a<-aov(LC50~Habitat,data=LC)
summary(a)
b<-aov(LC10~Habitat,data=LC)
summary(b)
TukeyHSD(b)
setwd("C:/Users/Piumi/SkyDrive/McGill Academics/Honours/Tanks")
tankCounts<-read.csv("TankCounts.csv")
View(tankCounts)
tankCounts$Treatment<-as.factor(tankCounts$Treatment)
factor(tankCounts$Treatment)
means<-aov(Means~Treatment)
means<-aov(Means~Treatment,data=tankCounts)
summary(means)
cov<-aov(COV~Treatment,data=tankCounts)
summary(cov)
TukeyHSD(means)
TukeyHSD(cov)
plot(TukeyHSD(means))
pair1<-subset(tankCounts,Tank..<10)
View(pair1)
pair2<-subset(tankCounts,Tank..>9)
paired.t.test(pair1,pair2)
t.test(pair1,pair2,paired=TRUE)
t.test(pair1$Means,pair2$Means,paired=TRUE)
t.test(pair1$COV,pair2$COV,paired=TRUE)
summary(manova(cbind(LC10,LC50)~Habitat,data=LC))
tankCounts<-read.csv("TankCounts.csv")
tankCounts$Treatment<-as.factor(tankCounts$Treatment)
tankCounts$Pair<-as.factor(tankCounts$Pair)
factor(tankCounts$Pair)
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts),test="Pillai")
summary(manova(cbind(Means,COV)~Treatment*Pair),test="Pillai")
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts),test="Pillai")
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts))
cbind(tankCounts$Means,tankCounts$COV)
summary(manova(cbind(Means,COV)~Treatment,tankCounts))
manova(cbind(Means,COV)~Treatment,tankCounts)
manova(cbind(Means,COV)~Treatment*Pair,tankCounts)
View(tankCounts)
tankCounts<-read.csv("TankCounts.csv")
tankCounts$Treatment<-as.factor(tankCounts$Treatment)
tankCounts$Pair<-as.factor(tankCounts$Pair)
summary(manova(cbind(Means,COV)~Treatment,tankCounts))
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts))
manova(cbind(Means,COV)~Treatment*Pair,tankCounts)
tankCounts<-read.csv("TankCounts.csv")
tankCounts$Treatment<-as.factor(tankCounts$Treatment)
tankCounts$Pair<-as.factor(tankCounts$Pair)
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts))
summary(aov(cbind(Means,COV)~Treatment*Pair),tankCounts)
summary(aov(cbind(Means,COV)~Treatment*Pair,tankCounts))
summary(manova(cbind(LC10,LC50)~Habitat,data=LC))
summary(aov(cbind(LC10,LC50)~Habitat,data=LC))
tankCounts<-read.csv("TankCounts.csv")
tankCounts$Treatment<-as.factor(tankCounts$Treatment)
tankCounts$Pair<-as.factor(tankCounts$Pair)
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts))
summary(aov(cbind(Means,COV)~Treatment*Pair,tankCounts))
?lme
library(x)
??lme
install.packages(nlme)
install.packages("nlme")
library (x)
library(nlme)
?lme
tankCounts<-read.csv("TankCounts.csv")
tankCounts$Treatment<-as.factor(tankCounts$Treatment)
tankCounts$Pair<-as.factor(tankCounts$Pair)
tankCounts$ID<-as.factor(tankCounts$ID)
lme<-lme(MEANS~Treatment+Pair,random=~1|ID,data=tankCounts)
lme<-lme(Means~Treatment+Pair,random=~1|ID,data=tankCounts)
summary(lme)
lme<-lme(Means~Treatment*Pair,random=~1|ID,data=tankCounts)
summary(lme)
View(tankCounts)
anova(lme)
lme<-lme(littler~Treatment*Pair,random=~1|ID,data=tankCounts)
anova(lme)
summary(manova(cbind(Means,COV)~Treatment*Pair,tankCounts))
summary(manova(cbind(Means,COV)~Treatment*ID,tankCounts))
summary(aov(cbind(Means,COV)~Treatment*ID,tankCounts))
summary(manova(cbind(Means,COV,littler)~Treatment*ID,tankCounts))
summary(manova(cbind(Means,littler)~Treatment*ID,tankCounts))
summary(aov(cbind(Means,littler)~Treatment*ID,tankCounts))
summary(aov(cbind(Means,littler)~Treatment*ID,tankCounts))
lme<-lme(Means~Treatment,random=~1|ID,data=tankCounts)
anova(lme)
summary(manova(cbind(Means,littler)~Treatment*ID,tankCounts))
summary(aov(cbind(Means,littler)~Treatment*ID,tankCounts))
treatmt<-aov(cbind(Means,littler)~Treatment*ID,tankCounts))
summary(manova(cbind(Means,littler)~Treatment*ID,tankCounts))
treatmt<-aov(cbind(Means,littler)~Treatment*ID,tankCounts))
treatmt<-aov(cbind(Means,littler)~Treatment*ID,tankCounts)
TukeyHSD(treatmt)
pair1<-subset(tankCounts,Pair==1)
pair2<-subset(tankCounts,Pair==2)
t.test(pair1,pair2,paired==TRUE)
t.test(pair1$Means,pair2$Means,paired==TRUE)
t.test(pair1$Means,pair2$Means,paired=TRUE)
t.test(pair1$Means,pair2$littler,paired=TRUE)
t.test(pair1$littler,pair2$littler,paired=TRUE)
library(MASS)
toxTest<-read.csv('toxTest.csv')
setwd("C:/Users/Piumi/OneDrive/McGill Academics/2013-2014/Honours/Tox test")
toxTest<-read.csv('toxTest.csv')
glmlist<-vector(mode="list",length=21)
doselist<-vector(mode="list",length=21)
for (i in 3:23){
tox.temp<-toxTest[complete.cases(toxTest[,i]),c(2,i)]
dead<-tox.temp[,2]
alive<-100-tox.temp[,2]
glmlist[[i-2]]<-glm(cbind(dead,alive) ~ log(tox.temp$Conc), family = binomial(link = "probit"))
doselist[[i-2]]<-dose.p(glmlist[[i-2]],1:2,0.5)
}
doselist<-vector(mode="list",length=21)
for (i in 3:23){
tox.temp<-toxTest[complete.cases(toxTest[,i]),c(2,i)]
tox.temp<-tox.temp[-1,]
dead<-tox.temp[,2]
alive<-100-tox.temp[,2]
glmlist[[i-2]]<-glm(cbind(dead,alive) ~ log(tox.temp$Conc), family = binomial(link = "probit"))
doselist[[i-2]]<-dose.p(glmlist[[i-2]],1:2,0.5)
}
lc50<-numeric(length=21)
lc50SE<-numeric(length=21)
lc10<-numeric(length=21)
lc10SE<-numeric(length=21)
for (i in 1:21){
lc50[i]<-exp(doselist[[i]][2])
lc50SE[i]<-attr(doselist[[i]],"SE")[2]
lc10[i]<-exp(doselist[[i]][1])
lc10SE[i]<-attr(doselist[[i]],"SE")[1]
}
LC<-data.frame(Type=rep(c("Pond","Lake"),c(12,9)),
Habitat=gsub('.[0-9]+',"",names(toxTest[3:23])),
Clone=names(toxTest[3:23]),
lc10,
lc10SE,
lc50,
lc50SE)
View(LC)
glmlist<-vector(mode="list",length=21)
doselist<-vector(mode="list",length=21)
for (i in 3:23){
tox.temp<-toxTest[complete.cases(toxTest[,i]),c(2,i)]
tox.temp<-tox.temp[-1,]
dead<-tox.temp[,2]
alive<-100-tox.temp[,2]
glmlist[[i-2]]<-glm(cbind(dead,alive) ~ log(tox.temp$Conc), family = binomial(link = "probit"))
doselist[[i-2]]<-dose.p(glmlist[[i-2]],1:2,c(0.1,0.5))
}
lc50<-numeric(length=21)
lc50SE<-numeric(length=21)
lc10<-numeric(length=21)
lc10SE<-numeric(length=21)
for (i in 1:21){
lc50[i]<-exp(doselist[[i]][2])
lc50SE[i]<-attr(doselist[[i]],"SE")[2]
lc10[i]<-exp(doselist[[i]][1])
lc10SE[i]<-attr(doselist[[i]],"SE")[1]
}
LC<-data.frame(Type=rep(c("Pond","Lake"),c(12,9)),
Habitat=gsub('.[0-9]+',"",names(toxTest[3:23])),
Clone=names(toxTest[3:23]),
lc10,
lc10SE,
lc50,
lc50SE)
View(LC)
data<-LC[,c(4,6)]
data<-t(data)
colnames(data)<-as.character(LC$Clone)
col<-c(rep(c("darkolivegreen2","forestgreen"),12),rep(c("cadetblue1","cornflowerblue"),9))
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.9,
inset=0.05)
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
par(def.par)  #- reset to default
data<-LC[,c(4,6)]
data<-t(data)
colnames(data)<-as.character(LC$Clone)
col<-c(rep(c("darkolivegreen2","forestgreen"),12),rep(c("cadetblue1","cornflowerblue"),9))
def.par <- par(no.readonly = TRUE)
## divide device into two rows and 1 column
## allocate figure 1  for barplot
## allocate figure 2 for barplot labels
## respect relations between widths and heights
nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
layout.show(nf)
## barplot
par(mar = c(0,1,1,1))
xx <- barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line", xaxt='n')
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.8,
inset=0.05)
## labels , create d ummy plot for sacles
par(mar = c(1,1,0,1))
plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
## Create some text labels
labels <- colnames(data)
## Plot text labels with some rotation at the top of the current figure
text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
labels = labels, xpd = TRUE,cex=0.8,srt=60)
par(def.par)  #- reset to default
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line")
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.8,
inset=0.05)
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.8)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.75,
inset=0.01)
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.8)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.7)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
help(barplot)
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.7,
offset=0.1)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.7,
offset=0)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
par(mgp=c(2,1,0))
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.7,
offset=0)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
par(mgp=c(3,1,0))
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.7,
offset=0)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
library(MASS)
toxTest<-read.csv('toxTest.csv')
glmlist<-vector(mode="list",length=21)
doselist<-vector(mode="list",length=21)
for (i in 3:23){
tox.temp<-toxTest[complete.cases(toxTest[,i]),c(2,i)]
tox.temp<-tox.temp[-1,]
dead<-tox.temp[,2]
alive<-100-tox.temp[,2]
glmlist[[i-2]]<-glm(cbind(dead,alive) ~ log(tox.temp$Conc), family = binomial(link = "probit"))
doselist[[i-2]]<-dose.p(glmlist[[i-2]],1:2,c(0.1,0.5))
}
lc50<-numeric(length=21)
lc50SE<-numeric(length=21)
lc10<-numeric(length=21)
lc10SE<-numeric(length=21)
for (i in 1:21){
lc50[i]<-exp(doselist[[i]][2])
lc50SE[i]<-attr(doselist[[i]],"SE")[2]
lc10[i]<-exp(doselist[[i]][1])
lc10SE[i]<-attr(doselist[[i]],"SE")[1]
}
LC<-data.frame(Type=rep(c("Pond","Lake"),c(12,9)),
Habitat=gsub('.[0-9]+',"",names(toxTest[3:23])),
Clone=names(toxTest[3:23]),
lc10,
lc10SE,
lc50,
lc50SE)
data<-LC[,c(4,6)]
data<-t(data)
colnames(data)<-as.character(LC$Clone)
col<-c(rep(c("darkolivegreen2","forestgreen"),12),rep(c("cadetblue1","cornflowerblue"),9))
# def.par <- par(no.readonly = TRUE)
#
# ## divide device into two rows and 1 column
# ## allocate figure 1  for barplot
# ## allocate figure 2 for barplot labels
# ## respect relations between widths and heights
#
# nf <- layout(matrix(c(1,1,2,2),2,2,byrow = TRUE), c(1,3), c(3,1), TRUE)
# layout.show(nf)
#
# ## barplot
# par(mar = c(0,1,1,1))
#
# xx <- barplot(data, beside=TRUE, ylim=c(140,170),
#               xpd=FALSE, col=col,
#               las=2, ylab="Cu Concentration(ug/L)",
#               xlab="Clonal Line", xaxt='n')
#
# legend("topright",
#        c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
#        fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
#        cex=0.8,
#        inset=0.05)
#
# ## labels , create d ummy plot for sacles
# par(mar = c(1,1,0,1))
# plot(seq_len(length(xx)),rep(1,length(xx)),type='n',axes=FALSE)
# ## Create some text labels
# labels <- colnames(data)
# ## Plot text labels with some rotation at the top of the current figure
# text(seq(1.5,42,by=2),rep(1.4,length(xx)/2), srt = 90, adj = 1,
#      labels = labels, xpd = TRUE,cex=0.8,srt=60)
#
# par(def.par)  #- reset to default
barplot(data, beside=TRUE, ylim=c(140,170),
xpd=FALSE, col=col,
las=2, ylab="Cu Concentration(ug/L)",
xlab="Clonal Line",cex.names = 0.7,
offset=0)
legend("topright",
c("LC10 Ponds","LC50 Ponds", "LC10 Lakes", "LC50 Lakes"),
fill=c("darkolivegreen2","forestgreen","cadetblue1","cornflowerblue"),
cex=0.7,
inset=0.01)
